<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Room {{ room.room_number }} Details</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Public+Sans%3Awght%40400%3B500%3B700%3B900"
    />
    <style>
      :root{--bg:#f5f6fb;--card:#fff;--muted:#617589;--text:#0f172a;--border:#e6e9ef;--accent:#0f172a;--radius:12px;font-family:"Public Sans","Noto Sans",system-ui,Arial}
      *{box-sizing:border-box}
      body{margin:0;background:var(--bg);color:var(--text);font-family:inherit}
      header{background:#fff;border-bottom:1px solid var(--border);padding:12px 20px;display:flex;align-items:center;justify-content:space-between}
      header h1{margin:0;font-size:18px}
      .container{max-width:1100px;margin:20px auto;padding:18px}

      .back{display:inline-block;margin-bottom:12px;background:var(--card);padding:8px 10px;border-radius:8px;border:1px solid var(--border);text-decoration:none;color:var(--text)}

      .layout{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
      .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:14px}
      .card h2{margin-top:0}
      table.detail{width:100%;border-collapse:collapse;margin-top:8px}
      table.detail th, table.detail td{padding:10px;border-bottom:1px solid #f1f4f8;text-align:left;vertical-align:top}
      table.detail th{width:180px;color:var(--muted);font-weight:600}

      .image-wrap{display:flex;flex-direction:column;gap:8px}
      .image-wrap img{max-width:100%;border-radius:8px;border:1px solid var(--border)}
      .students-list{list-style:none;padding:0;margin:0}
      .students-list li{padding:8px;border-bottom:1px solid #f1f4f8}

      form label{display:block;margin-bottom:6px;color:var(--muted)}
      select, button{padding:8px;border-radius:8px;border:1px solid var(--border);width:100%}
      button{background:var(--accent);color:white;border:0;cursor:pointer;margin-top:10px}

      .muted{color:var(--muted)}

      @media (max-width:940px){.layout{grid-template-columns:1fr}.container{padding:12px}}
    </style>
  </head>
  <body>
    <header>
      <h1>Room {{ room.room_number }}</h1>
      <div>
        <a class="back" href="{% url 'rooms_list' %}"> Back to Rooms List</a>
      </div>
    </header>

    <main class="container">
      <div class="layout">
        <div>
          <div class="card">
            <h2>Room Information</h2>
            <table class="detail">
              <tr><th>Block</th><td>{{ room.block_number }}</td></tr>
              <tr><th>Type</th><td>{{ room.type }}</td></tr>
              <tr><th>Capacity</th><td>{{ room.capacity }}</td></tr>
              <tr><th>Occupied</th><td>{{ room.occupied }}</td></tr>
              <tr><th>Rent</th><td>â‚¹{{ room.room_rent }}</td></tr>
              <tr><th>Status</th><td>{{ room.status }}</td></tr>
              <tr><th>Created At</th><td>{{ room.created_at|date:"Y-m-d H:i" }}</td></tr>
              <tr>
                <th>Image</th>
                <td>
                  <div class="image-wrap">
                    {% if room.image %}
                      <img src="{{ room.image.url }}" alt="Room Image">
                      <a href="{{ room.image.url }}" target="_blank">View full image</a>
                    {% else %}
                      <div class="muted">No image uploaded</div>
                    {% endif %}
                  </div>
                </td>
              </tr>
            </table>
          </div>

          <div class="card" style="margin-top:14px">
            <h2>Students in this Room</h2>
            {% if students %}
              <ul class="students-list">
                {% for s in students %}
                  <li><a href="{% url 'student_detail' s.student_id %}">{{ s.name }}</a> <span class="muted">({{ s.student_id }})</span></li>
                {% endfor %}
              </ul>
            {% else %}
              <p class="muted">No students in this room.</p>
            {% endif %}
          </div>
        </div>

        <aside>
          <div class="card">
            <h2>Edit Room</h2>
            <form method="post">
              {% csrf_token %}
              <label for="status">Status</label>
              <select name="status" id="status">
                {% for val, label in status_choices %}
                  <option value="{{ val }}" {% if room.status == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>

              <button type="submit">Save Changes</button>
            </form>
          </div>
        </aside>
      </div>
    </main>
  </body>
</html>
